# Bereite eine vereinfachte Datenstruktur für die Gäste vor (Name → Tisch)
import pandas as pd

# Extrahierte Zuordnung aus dem Word-Dokument
guest_table_data = {
    "Al Mallah": 28, "Albert": 15, "Bakir": 23, "Bochem": 25, "Brüßel": 43, "Bugatto": 41,
    "Bähr": 21, "Böhme": 31, "Büllesbach": 37, "Cevela": 26, "Chmiel": 4, "Christian": 19,
    "Cosic": 45, "Cumpanici": 38, "De Waele": 5, "Diewald": 10, "Dresen": 22, "Eck": 10,
    "Eckhard": 46, "Ekler": 11, "Fichna": 37, "Friesen": 2, "Gardi": 41, "Gensel": 9,
    "Gerboga": 40, "Gottschling": 27, "Habroune": 27, "Hansen": 1, "Hartmann": 35,
    "Hashemian": 20, "Hemgesberg": 20, "Henseler": 11, "Herweg": 36, "Hirgen": 10,
    "Hoffmann": 36, "Hußlein": 39, "Jäger": 28, "Kaasch": 29, "Kelter": 39, "Kempchen": 44,
    "Klein": 3, "Konda": 31, "Krasniqui": 24, "Krieger": 38, "Kriese": 33, "Krämer": 8,
    "LehrerInnen": 6, "Lischke": 46, "Lojade": 1, "Lübke": 14, "Mahlberg": 35, "Maktad": 25,
    "Marienfeld": 13, "Mazur": 44, "McCann": 13, "Michalska": 24, "Milani": 24, "Over": 26,
    "Petereit": 32, "Poggel": 17, "Quannani": 42, "Raaf": 2, "Reuter": 30, "Rexhepi": 41,
    "Richter": 18, "Rillig": 3, "Ritz": 4, "Romauer": 43, "Romes": 16, "Roos": 12,
    "Salomon": 5, "Schilling": 42, "Schmiing": 32, "Schmitz. B": 30, "Schmitz. N": 45,
    "Schultheis": 15, "Schwarz": 16, "Shakir": 42, "Simon": 19, "Sistig": 33, "Steinhoff": 12,
    "Straßburger": 8, "Studeny": 11, "Thevis": 8, "Thome": 34, "Ucar": 29, "Wall": 42,
    "Wandel": 14, "Wehrend": 18, "Wölfing": 9, "Younssi": 42, "Yousif": 42, "Zubair": 40,
    "Zwick": 21, "v. Kannen": 3
}

# Umwandeln in JavaScript-Objekt als Text
guest_js = "const guests = {\n"
for name, table in sorted(guest_table_data.items()):
    guest_js += f'  "{name}": {table},\n'
guest_js += "};"

# HTML Template mit Suchfeld, Bild, Highlight-Funktion
html_template = f"""
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Sitzplatz-Suche Abiball</title>
  <style>
    body {{
      font-family: Arial, sans-serif;
      text-align: center;
    }}
    #seating-chart {{
      position: relative;
      display: inline-block;
    }}
    #seating-chart img {{
      max-width: 100%;
      height: auto;
    }}
    .highlight {{
      position: absolute;
      border: 3px solid red;
      border-radius: 50%;
      pointer-events: none;
      box-shadow: 0 0 10px red;
    }}
    select {{
      margin: 20px;
      font-size: 16px;
      padding: 5px;
    }}
  </style>
</head>
<body>
  <h1>Sitzplatzsuche Abiball</h1>
  <p>Wähle deinen Namen aus, um deinen Tisch zu sehen:</p>
  <select id="nameSelect" onchange="highlightTable()">
    <option value="">-- Bitte Namen wählen --</option>
    {''.join([f'<option value="{name}">{name}</option>' for name in sorted(guest_table_data)])}
  </select>

  <div id="seating-chart">
    <img src="sitzplan.png" alt="Sitzplan">
    <div id="highlightBox" class="highlight" style="display:none;"></div>
  </div>

  <script>
    {guest_js}

    const tablePositions = {{
      // Tischnummer: [x, y, width, height] — Werte als Prozentsätze (ungefähr! Du kannst sie später anpassen)
      1: [10, 10, 5, 5], 2: [20, 10, 5, 5], 3: [30, 10, 5, 5], 4: [40, 10, 5, 5],
      5: [10, 20, 5, 5], 6: [20, 20, 5, 5], 7: [30, 20, 5, 5], 8: [40, 20, 5, 5],
      9: [10, 30, 5, 5], 10: [20, 30, 5, 5], 11: [30, 30, 5, 5], 12: [40, 30, 5, 5],
      13: [10, 40, 5, 5], 14: [20, 40, 5, 5], 15: [30, 40, 5, 5], 16: [40, 40, 5, 5],
      17: [10, 50, 5, 5], 18: [20, 50, 5, 5], 19: [30, 50, 5, 5], 20: [40, 50, 5, 5],
      21: [10, 60, 5, 5], 22: [20, 60, 5, 5], 23: [30, 60, 5, 5], 24: [40, 60, 5, 5],
      25: [10, 70, 5, 5], 26: [20, 70, 5, 5], 27: [30, 70, 5, 5], 28: [40, 70, 5, 5],
      29: [10, 80, 5, 5], 30: [20, 80, 5, 5], 31: [30, 80, 5, 5], 32: [40, 80, 5, 5],
      33: [85, 10, 5, 5], 34: [85, 15, 5, 5], 35: [85, 20, 5, 5], 36: [85, 25, 5, 5],
      37: [85, 30, 5, 5], 38: [85, 35, 5, 5], 39: [85, 40, 5, 5], 40: [85, 45, 5, 5],
      41: [85, 50, 5, 5], 42: [5, 10, 5, 5], 43: [5, 15, 5, 5], 44: [5, 20, 5, 5],
      45: [5, 25, 5, 5], 46: [5, 30, 5, 5]
    }};

    function highlightTable() {{
      const name = document.getElementById("nameSelect").value;
      const table = guests[name];
      const box = document.getElementById("highlightBox");
      if (!table || !tablePositions[table]) {{
        box.style.display = "none";
        return;
      }}
      const [x, y, w, h] = tablePositions[table];
      box.style.display = "block";
      box.style.left = x + "%";
      box.style.top = y + "%";
      box.style.width = w + "%";
      box.style.height = h + "%";
    }}
  </script>
</body>
</html>
"""

# Speichere den HTML-Code in eine Datei
html_path = "/mnt/data/sitzplan_app.html"
with open(html_path, "w", encoding="utf-8") as f:
    f.write(html_template)

html_path
